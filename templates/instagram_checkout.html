{% extends 'base.html' %}

{% block title %}Complete Your Order on Instagram{% endblock %}

{% block content %}
<div class="container my-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0 text-white"><i class="fab fa-instagram me-2 text-white"></i> Complete Your Order on Instagram</h4>
                </div>
                <div class="card-body">
                    <p class="card-text">
                        Your order has been created successfully! To proceed and finalize your purchase, please follow the steps below:
                    </p>
                    <ol>
                        <li>Click the "Copy Order Details" button below to copy all your order information.</li>
                        <li>Click the "Continue to Instagram" button to open a DM chat with our store account.</li>
                        <li>Once on Instagram, **paste** the copied order details into the message field and send it.</li>
                    </ol>

                    <div class="mb-4">
                        <label for="orderMessage" class="form-label">Your Order Details:</label>
                        <textarea id="orderMessage" class="form-control" rows="10" readonly>{{ full_message }}</textarea>
                    </div>

                    <div class="d-grid gap-2">
                        <button type="button" class="btn btn-primary btn-lg" id="copyButton">
                            <i class="bi bi-clipboard me-2"></i> Copy Order Details
                        </button>
                        <a href="https://ig.me/m/{{ instagram_username }}/" class="btn btn-primary btn-lg mt-3" target="_blank" rel="noopener noreferrer">
                            <i class="fab fa-instagram me-2"></i> Continue to Instagram
                        </a>
                    </div>

                    <div class="mt-4 text-center">
                        <p class="text-muted">If you encounter any issues, please contact us directly on Instagram <a href="https://instagram.com/{{ instagram_username }}" target="_blank" rel="noopener noreferrer">@{{ instagram_username }}</a>.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // JavaScript for copy to clipboard function
    document.getElementById('copyButton').addEventListener('click', function() {
        var copyText = document.getElementById('orderMessage');
        copyText.select();
        copyText.setSelectionRange(0, 99999); // For mobile devices

        try {
            document.execCommand('copy');
            alert('Order details successfully copied to clipboard!');
        } catch (err) {
            console.error('Failed to copy text: ', err);
            alert('Failed to copy text. Please copy manually.');
        }
    });
</script>
{% endblock %}